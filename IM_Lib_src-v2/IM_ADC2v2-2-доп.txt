
// результаты измерений АЦП [0]-для канала 0, [1] - для канала 1
typedef
struct {
   
   u8    fA;   // =1 - измерений результат обновился
   float A;  // результат измерения после усреднения
   /// диагностика
   u8 FN;          // =1 результат дигностики обновился
   u16 N,Ns;     //  счетчик результатов всего и за секунду( Обновляется один раз в секунду)         
    
   
 
} IM_ADC_R; 

IM_ADC_R IM_ADCr[2];


// внутренняя структуа
 struct {
 u8 zr;     // заданный режим в IM_ADC_reg
 ADC2_PresSel_TypeDef prsc;    // заданная скорость преобразования АЦП  
 u8 pr1 ; // признак =0 - каналы не переключаются 
 u8 pr2 ; // 1 переключать после каждого измерения, 0- после набора суммы для среднего
 u8 CnAI; // 0,1 - тек ном канала для прерываний 

 u16         ns0, ns1; // заданное число усреднений по каналами
 float      fns0,fns1; // =1/ns
 
 u32      aI0,  aI1; // текущая сумма показаний АЦП для усреднения внутри прерывания
 u16    cntI0,cntI1; //  текущий счетчик измерений , внутри прерывания
 
 u32      a0 ,  a1;  // набранная сумма показаний АЦП для усреднения 
 u16    cnt0 ,cnt1;  //  реальный счетчик измерений  
 u8       fL0, fL1;    // признак - =1 сумма набралась, 


 u16 tmpI; // чтение АЦП в прерываниях
 
  float      fns0,fns1; // =1/ns

  
u32 cntI;        // общий счетчик прерываний-измерений
u32 cnt0_,cnt1_  // счетчики результатов усредненных измерений
} IM_ADCrab ;   // IM_ADCrab.fL0


